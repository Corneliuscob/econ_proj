<!DOCTYPE html>
<meta charset="utf-8">
<svg width="960" height="500"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

var data = [
    {
		"year": "1",
		"pos": "1572444",
		"neg": "-1280605.52"
	},
	{
		"year": "2",
		"pos": "1603892.88",
		"neg": "-1301882.5104000003"
	},
	{
		"year": "3",
		"pos": "1635970.7376000001",
		"neg": "-1326178.9006080001"
	},
	{
		"year": "4",
		"pos": "1668690.1523519999",
		"neg": "-1350961.2186201601"
	},
	{
		"year": "5",
		"pos": "1702063.9553990401",
		"neg": "-1376239.1829925636"
	},
	{
		"year": "6",
		"pos": "1736105.2345070208",
		"neg": "-1402022.7066524145"
	},
	{
		"year": "7",
		"pos": "1770827.3391971611",
		"neg": "-1428321.9007854627"
	},
	{
		"year": "8",
		"pos": "1806243.8859811043",
		"neg": "-1455147.0788011719"
	},
	{
		"year": "9",
		"pos": "1842368.7637007264",
		"neg": "-1482508.7603771952"
	},
	{
		"year": "10",
		"pos": "1879216.1389747411",
		"neg": "-1510417.6755847393"
	},
	{
		"year": "11",
		"pos": "1916800.4617542357",
		"neg": "-1538884.7690964339"
	},
	{
		"year": "12",
		"pos": "1955136.47098932",
		"neg": "-1567921.2044783626"
	},
	{
		"year": "13",
		"pos": "1994239.2004091069",
		"neg": "-1644050.3685679298"
	},
	{
		"year": "14",
		"pos": "2034123.9844172888",
		"neg": "-1674259.8759392886"
	},
	{
		"year": "15",
		"pos": "2074806.4641056345",
		"neg": "-1705073.5734580741"
	},
	{
		"year": "16",
		"pos": "2116302.5933877476",
		"neg": "-1736503.5449272359"
	},
	{
		"year": "17",
		"pos": "2158628.6452555023",
		"neg": "-1768562.1158257807"
	},
	{
		"year": "18",
		"pos": "2201801.2181606125",
		"neg": "-1801261.8581422963"
	},
	{
		"year": "19",
		"pos": "2245837.2425238248",
		"neg": "-1834615.5953051425"
	},
	{
		"year": "20",
		"pos": "2290753.9873743015",
		"neg": "-1868636.407211245"
	},
	{
		"year": ""
	}
];

var series = d3.stack()
    .keys(["pos", "neg"])
    .offset(d3.stackOffsetDiverging)
    (data);

var svg = d3.select("svg"),
    margin = {top: 20, right: 30, bottom: 30, left: 60},
    width = +svg.attr("width"),
    height = +svg.attr("height");

var x = d3.scaleBand()
    .domain(data.map(function(d) { return d.year; }))
    .rangeRound([margin.left, width - margin.right])
    .padding(0.1);

var y = d3.scaleLinear()
    .domain([d3.min(series, stackMin), d3.max(series, stackMax)])
    .rangeRound([height - margin.bottom, margin.top]);

var z = d3.scaleOrdinal(d3.schemeCategory10);

svg.append("g")
  .selectAll("g")
  .data(series)
  .enter().append("g")
    .attr("fill", function(d) { return z(d.key); })
  .selectAll("rect")
  .data(function(d) { return d; })
  .enter().append("rect")
    .attr("width", x.bandwidth)
    .attr("x", function(d) { return x(d.data.year); })
    .attr("y", function(d) { return y(d[1]); })
    .attr("height", function(d) { return y(d[0]) - y(d[1]); })

svg.append("g")
    .attr("transform", "translate(0," + y(0) + ")")
    .call(d3.axisBottom(x));

svg.append("g")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(d3.axisLeft(y));

function stackMin(serie) {
  return d3.min(serie, function(d) { return d[0]; });
}

function stackMax(serie) {
  return d3.max(serie, function(d) { return d[1]; });
}

</script>
